package dev._2lstudios.exploitfixer.managers;

import java.util.HashMap;
import java.util.Map;
import java.util.UUID;

import org.bukkit.Server;
import org.bukkit.entity.Player;
import org.bukkit.plugin.Plugin;

import dev._2lstudios.exploitfixer.exploit.BukkitExploitPlayer;

public class ExploitPlayerManager {
	private Plugin plugin;
	private Server server;
	private ModuleManager moduleManager;
	private Map<UUID, BukkitExploitPlayer> exploitPlayers = new HashMap<>();

	// Amount of kicked players
	private int kicked = 0;

	// Amount of packets cancelled
	private int packetsCancelled = 0;

	ExploitPlayerManager(Plugin plugin, Server server, ModuleManager moduleManager) {
		this.plugin = plugin;
		this.server = server;
		this.moduleManager = moduleManager;
	}

	public BukkitExploitPlayer getIfPresent(UUID uuid) {
		return exploitPlayers.getOrDefault(uuid, null);
	}

	public BukkitExploitPlayer get(UUID uuid) {
		BukkitExploitPlayer exploitPlayer;

		if (exploitPlayers.containsKey(uuid)) {
			exploitPlayer = exploitPlayers.get(uuid);
		} else {
			exploitPlayer = new BukkitExploitPlayer(this.plugin, moduleManager, uuid);
			exploitPlayers.put(uuid, exploitPlayer);
		}

		return exploitPlayer;
	}

	public BukkitExploitPlayer get(Player player) {
		return get(player.getUniqueId());
	}

	public void remove(UUID uuid) {
		exploitPlayers.remove(uuid);
	}

	public void remove(Player player) {
		remove(player.getUniqueId());
	}

	public void reload() {
		exploitPlayers.clear();

		for (Player player : server.getOnlinePlayers()) {
			get(player);
		}
	}

	public int getSize() {
		return exploitPlayers.size();
	}

	public int getKicked() {
		return kicked;
	}

	public int addKicked() {
		return kicked++;
	}

	public int getPacketsCancelled() {
		return packetsCancelled;
	}

	public void addPacketsCancelled() {
		packetsCancelled += 1;
	}
}